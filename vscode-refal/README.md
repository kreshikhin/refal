# REFAL Language Support for VS Code

Расширение для Visual Studio Code, обеспечивающее подсветку синтаксиса для языка программирования REFAL.

## Возможности

- ✅ Подсветка синтаксиса для файлов `.ref`
- ✅ Поддержка комментариев (`** комментарий **`)
- ✅ Подсветка строковых литералов (`'строка'`)
- ✅ Подсветка числовых литералов
- ✅ Подсветка всех ключевых слов REFAL
- ✅ Подсветка функций (начинающихся с заглавной буквы)
- ✅ Подсветка переменных (`s.var`, `e.var`, `v.var`)
- ✅ Подсветка операторов и пунктуации
- ✅ Автозакрытие скобок и кавычек
- ✅ Автоматическое форматирование отступов
- ✅ Сворачивание блоков кода

## Установка

### Локальная установка

1. Склонируйте репозиторий:
```bash
git clone https://github.com/kreshikhin/refal.git
cd refal/vscode-refal
```

2. Установите зависимости:
```bash
npm install
```

3. Соберите расширение:
```bash
npm run package
```

4. Установите `.vsix` файл в VS Code:
   - Откройте VS Code
   - Перейдите в Extensions (Ctrl+Shift+X)
   - Нажмите "..." в правом верхнем углу
   - Выберите "Install from VSIX..."
   - Выберите созданный `.vsix` файл

### Установка из Marketplace

Расширение будет доступно в VS Code Marketplace после публикации.

## Использование

После установки расширения:

1. Откройте файл с расширением `.ref`
2. VS Code автоматически определит язык как REFAL
3. Наслаждайтесь подсветкой синтаксиса!

## Пример кода

```refal
** Пример программы на REFAL **
$ENTRY Go {
  = <Hello>;
}

$EXTERN ExternalFunction;

$TABLE MyTable {
  'key1' = 'value1';
}

$INC "lib.rf";

$DEFINE MAX_SIZE 1000;

$INFIX Add;

Hello {
  = 'Hello, World!';
}

Factorial {
  0 = 1;
  s.N = <Mul s.N <Factorial <Sub s.N 1>>>;
}
```

## Поддерживаемые элементы синтаксиса

### Ключевые слова REFAL
- **$ENTRY** - точка входа программы (функция Go, Main и т.п.)
- **$EXTERN** - объявление внешней функции, реализованной вне текущего файла
- **$LABEL** - внутреннее имя шаблона, для переходов (редко используется)
- **$TABLE** - объявление таблицы — хеш-таблица для сопоставлений
- **$INC** - включение другого файла ($INC "lib.rf"), аналог #include
- **$DEFINE** - макроопределение, иногда используется для параметров
- **$INFIX** - объявление функции как инфиксной (для +, * и т.п.)

### Другие элементы
- **Комментарии**: `** комментарий **`
- **Строки**: `'текст'`
- **Числа**: `123`, `0`, `42`
- **Функции**: `Hello`, `Factorial`, `Add`, `Sub`
- **Переменные**: `s.name`, `e.expr`, `v.value`
- **Операторы**: `=`, `<`, `>`
- **Пунктуация**: `{`, `}`, `<`, `>`, `;`, `,`

## Разработка

### Структура проекта

```
vscode-refal/
├── package.json              # Конфигурация расширения
├── language-configuration.json # Настройки языка
├── syntaxes/
│   └── refal.tmLanguage.json # TextMate grammar
├── test-example.ref          # Пример для тестирования
├── test-keywords.ref         # Тест всех ключевых слов
├── README.md                 # Документация
├── INSTALL.md               # Инструкция по установке
└── .vscodeignore            # Исключения из пакета
```

### Добавление новых элементов синтаксиса

Для добавления новых элементов синтаксиса отредактируйте файл `syntaxes/refal.tmLanguage.json`.

### Тестирование

1. Нажмите F5 в VS Code для запуска расширения в режиме отладки
2. Откройте файл `test-example.ref` или `test-keywords.ref` в новом окне VS Code
3. Проверьте подсветку синтаксиса

## Лицензия

MIT License

## Автор

Denis Kreshikhin 