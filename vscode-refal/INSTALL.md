# Инструкция по установке VS Code расширения для REFAL

## Быстрая установка

### Шаг 1: Подготовка
```bash
cd vscode-refal
npm install
```

### Шаг 2: Сборка расширения
```bash
npm run package
```

### Шаг 3: Установка в VS Code
1. Откройте VS Code
2. Нажмите `Ctrl+Shift+X` (или `Cmd+Shift+X` на Mac) для открытия Extensions
3. Нажмите на `...` в правом верхнем углу панели Extensions
4. Выберите "Install from VSIX..."
5. Выберите файл `vscode-refal-0.1.0.vsix` из папки `vscode-refal`

## Тестирование расширения

### Метод 1: Режим отладки (рекомендуется для разработки)
1. Откройте папку `vscode-refal` в VS Code
2. Нажмите `F5` для запуска расширения в режиме отладки
3. В новом окне VS Code откройте файл `test-example.ref` или `test-keywords.ref`
4. Проверьте подсветку синтаксиса

### Метод 2: Обычная установка
1. Установите расширение по инструкции выше
2. Откройте любой файл с расширением `.ref`
3. VS Code автоматически применит подсветку синтаксиса

## Что должно подсвечиваться

### Ключевые слова REFAL (синим цветом)
- **$ENTRY** - точка входа программы
- **$EXTERN** - объявление внешней функции
- **$LABEL** - внутреннее имя шаблона
- **$TABLE** - объявление таблицы
- **$INC** - включение другого файла
- **$DEFINE** - макроопределение
- **$INFIX** - объявление инфиксной функции

### Другие элементы
- **Комментарии** (`** текст **`) - зеленым цветом
- **Строки** (`'текст'`) - оранжевым цветом  
- **Числа** (`123`) - светло-зеленым цветом
- **Функции** (`Hello`, `Factorial`) - желтым цветом
- **Переменные** (`s.N`, `e.expr`) - голубым цветом
- **Операторы** (`=`, `<`, `>`) - белым цветом
- **Скобки** (`{`, `}`, `<`, `>`) - белым цветом

## Устранение неполадок

### Расширение не работает
1. Проверьте, что файл имеет расширение `.ref`
2. Убедитесь, что расширение установлено (проверьте в Extensions)
3. Попробуйте перезапустить VS Code

### Подсветка не отображается
1. Нажмите `Ctrl+Shift+P` и введите "Change Language Mode"
2. Выберите "REFAL" из списка
3. Или выберите "Configure File Association for '.ref'"

### Ошибки при сборке
1. Убедитесь, что установлен Node.js
2. Проверьте, что все зависимости установлены: `npm install`
3. Проверьте синтаксис JSON файлов

## Разработка

### Добавление новых элементов синтаксиса
1. Отредактируйте `syntaxes/refal.tmLanguage.json`
2. Добавьте новые паттерны в соответствующие секции
3. Пересоберите расширение: `npm run package`
4. Переустановите расширение

### Отладка grammar
1. Используйте [TextMate Grammar Inspector](https://www.sublimetext.com/docs/scope_naming.html)
2. Проверьте scope names в VS Code: `Ctrl+Shift+P` → "Developer: Inspect Editor Tokens and Scopes"

## Публикация в Marketplace

1. Создайте аккаунт на [Visual Studio Marketplace](https://marketplace.visualstudio.com/)
2. Получите Personal Access Token
3. Выполните: `npm run publish`

## Структура файлов

```
vscode-refal/
├── package.json              # Конфигурация расширения
├── language-configuration.json # Настройки языка
├── syntaxes/
│   └── refal.tmLanguage.json # TextMate grammar
├── test-example.ref          # Пример для тестирования
├── test-keywords.ref         # Тест всех ключевых слов
├── README.md                 # Документация
├── INSTALL.md               # Эта инструкция
└── .vscodeignore            # Исключения из пакета
``` 